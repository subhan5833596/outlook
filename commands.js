/*! For license information please see commands.js.LICENSE.txt */
!function(){function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){"use strict";e=function(){return r};var n,r={},o=Object.prototype,c=o.hasOwnProperty,a=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},u=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function f(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(n){f=function(t,e,n){return t[e]=n}}function p(t,e,n,r){var o=e&&e.prototype instanceof v?e:v,c=Object.create(o.prototype),i=new G(r||[]);return a(c,"_invoke",{value:K(t,n,i)}),c}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}r.wrap=p;var d="suspendedStart",m="suspendedYield",g="executing",y="completed",A={};function v(){}function w(){}function b(){}var x={};f(x,u,(function(){return this}));var S=Object.getPrototypeOf,E=S&&S(S(N([])));E&&E!==o&&c.call(E,u)&&(x=E);var O=b.prototype=v.prototype=Object.create(x);function L(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function j(e,n){function r(o,a,i,u){var s=h(e[o],e,a);if("throw"!==s.type){var l=s.arg,f=l.value;return f&&"object"==t(f)&&c.call(f,"__await")?n.resolve(f.__await).then((function(t){r("next",t,i,u)}),(function(t){r("throw",t,i,u)})):n.resolve(f).then((function(t){l.value=t,i(l)}),(function(t){return r("throw",t,i,u)}))}u(s.arg)}var o;a(this,"_invoke",{value:function(t,e){function c(){return new n((function(n,o){r(t,e,n,o)}))}return o=o?o.then(c,c):c()}})}function K(t,e,r){var o=d;return function(c,a){if(o===g)throw Error("Generator is already running");if(o===y){if("throw"===c)throw a;return{value:n,done:!0}}for(r.method=c,r.arg=a;;){var i=r.delegate;if(i){var u=W(i,r);if(u){if(u===A)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===d)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=g;var s=h(t,e,r);if("normal"===s.type){if(o=r.done?y:m,s.arg===A)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(o=y,r.method="throw",r.arg=s.arg)}}}function W(t,e){var r=e.method,o=t.iterator[r];if(o===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=n,W(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),A;var c=h(o,t.iterator,e.arg);if("throw"===c.type)return e.method="throw",e.arg=c.arg,e.delegate=null,A;var a=c.arg;return a?a.done?(e[t.resultName]=a.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=n),e.delegate=null,A):a:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,A)}function V(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function k(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function G(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(V,this),this.reset(!0)}function N(e){if(e||""===e){var r=e[u];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function t(){for(;++o<e.length;)if(c.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=n,t.done=!0,t};return a.next=a}}throw new TypeError(t(e)+" is not iterable")}return w.prototype=b,a(O,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:w,configurable:!0}),w.displayName=f(b,l,"GeneratorFunction"),r.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,f(t,l,"GeneratorFunction")),t.prototype=Object.create(O),t},r.awrap=function(t){return{__await:t}},L(j.prototype),f(j.prototype,s,(function(){return this})),r.AsyncIterator=j,r.async=function(t,e,n,o,c){void 0===c&&(c=Promise);var a=new j(p(t,e,n,o),c);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},L(O),f(O,l,"Generator"),f(O,u,(function(){return this})),f(O,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},r.values=N,G.prototype={constructor:G,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(k),!t)for(var e in this)"t"===e.charAt(0)&&c.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=n)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(r,o){return i.type="throw",i.arg=t,e.next=r,o&&(e.method="next",e.arg=n),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var u=c.call(a,"catchLoc"),s=c.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&c.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,A):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),A},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),k(n),A}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;k(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:N(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=n),A}},r}function n(t,e,n,r,o,c,a){try{var i=t[c](a),u=i.value}catch(t){return void n(t)}i.done?e(u):Promise.resolve(u).then(r,o)}function r(t){return function(){var e=this,r=arguments;return new Promise((function(o,c){var a=t.apply(e,r);function i(t){n(a,o,c,i,u,"next",t)}function u(t){n(a,o,c,i,u,"throw",t)}i(void 0)}))}}var o,c={};Office.onReady((function(){o=Office.context.mailbox.item}));var a="http://www.centreblock.org/";function i(){var t=new Date,e=t.getFullYear().toString().slice(-2),n=(t.getMonth()+1).toString().padStart(2,"0"),r=t.getDate().toString().padStart(2,"0"),o=t.getHours().toString().padStart(2,"0"),c=t.getMinutes().toString().padStart(2,"0");return"".concat(r,"-").concat(n,"-").concat(e,"_").concat(o,".").concat(c)}function u(){return(u=r(e().mark((function t(n){var r,c,u,s,l,f,p,h,d,m,g,y,A,v,w,b,x,S,E,O;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,new Promise((function(t,e){o.to.getAsync((function(n){n.status===Office.AsyncResultStatus.Succeeded?t(n.value):e(n.error)}))}));case 3:return r=t.sent,t.next=6,new Promise((function(t,e){o.cc.getAsync((function(n){n.status===Office.AsyncResultStatus.Succeeded?t(n.value):e(n.error)}))}));case 6:return c=t.sent,t.next=9,new Promise((function(t,e){o.subject.getAsync((function(n){n.status===Office.AsyncResultStatus.Succeeded?t(n.value):e(n.error)}))}));case 9:u=t.sent,s=r.map((function(t){return t.emailAddress})).join(", "),l=c.length>0?c.map((function(t){return t.emailAddress})).join(", "):"blank",f="e-mail_".concat(i()).replace(/ /g,"_"),p=s.replace(/ /g,"_"),h=Office.context.mailbox.userProfile.emailAddress.replace(/ /g,"_"),d=f.replace(/ /g,"_"),m=u.replace(/ /g,"_"),g=l.replace(/ /g,"_"),y="?utm_campaign=".concat(p,"&utm_source=").concat(h,"&utm_medium=").concat(d,"&utm_content=").concat(m,"&utm_term=").concat(g),A=a+y,console.log(A),w=Office.context.mailbox.userProfile.displayName,(b=localStorage.getItem("signatureHtml"))?(x=JSON.parse(b),v=x.html):(console.error("No signature HTML found in localStorage."),v="<p>".concat(w,'</p><p><a data-fr-linked="true" href="http://www.centreblock.org/" id="isPasted">http://www.centreblock.org/</a></p><p><img src="data:image/png;base64,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" style="width: 114px;" class="fr-fic fr-dib fr-fil"></p><p><br></p>')),S='<a href="'.concat(A,'" target="_blank">').concat(a,"</a>"),E=v.replace(/<p[^>]*data-f-id="pbf"[^>]*>.*?<a[^>]*href="https:\/\/www\.froala\.com\/wysiwyg-editor\?pb=1"[^>]*>.*?<\/a><\/p>/g,""),O=E.replace(/<a[^>]*>.*?<\/a>/g,S),console.log("Updated Signature HTML:",O),Office.context.mailbox.item.body.setSignatureAsync(O,{coercionType:"html"},(function(t){t.status===Office.AsyncResultStatus.Succeeded?(console.log("setSignatureAsync succeeded"),n.completed()):(console.error(t.error),n.completed())})),t.next=35;break;case 31:t.prev=31,t.t0=t.catch(0),console.error("Error populating UTM defaults:",t.t0),n.completed();case 35:n.completed();case 36:case"end":return t.stop()}}),t,null,[[0,31]])})))).apply(this,arguments)}function s(t){return l.apply(this,arguments)}function l(){return(l=r(e().mark((function t(n){var r,o,c,a,u,s,l,f;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,r=Office.context.mailbox.item,t.next=4,new Promise((function(t,e){r.to.getAsync((function(n){n.status===Office.AsyncResultStatus.Succeeded?t(n.value):e(n.error)}))}));case 4:return o=t.sent,t.next=7,new Promise((function(t,e){r.cc.getAsync((function(n){n.status===Office.AsyncResultStatus.Succeeded?t(n.value):e(n.error)}))}));case 7:return c=t.sent,t.next=10,new Promise((function(t,e){r.subject.getAsync((function(n){n.status===Office.AsyncResultStatus.Succeeded?t(n.value):e(n.error)}))}));case 10:a=t.sent,u=o.map((function(t){return t.emailAddress})).join(", "),s=c.length>0?c.map((function(t){return t.emailAddress})).join(", "):"blank",l="e-mail_".concat(i()).replace(/ /g,"_"),f=Office.context.mailbox.userProfile.emailAddress,n(null,u,f,l,a,s),t.next=21;break;case 18:t.prev=18,t.t0=t.catch(0),console.error("Error populating UTM defaults:",t.t0);case 21:case"end":return t.stop()}}),t,null,[[0,18]])})))).apply(this,arguments)}function f(t){return p.apply(this,arguments)}function p(){return(p=r(e().mark((function t(n){return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:try{s((function(t,e,r,o,c,u){if(t);else{var s,l=(e||"blank").replace(/ /g,""),f=(r||"blank").replace(/ /g,""),p=(o||"e-mail_".concat(i())).replace(/ /g,"_"),h=(c||"blank").replace(/ /g,"_"),d=(u||"blank").replace(/ /g,""),m="?utm_campaign=".concat(l,"&utm_source=").concat(f,"&utm_medium=").concat(p,"&utm_content=").concat(h,"&utm_term=").concat(d),g=a+m;n.value?(console.log(n),(s=n.value.replace(/<a\s+[^>]*href="[^"]*"[^>]*>/g,(function(t){return t.replace(/href="[^"]*"/,'href="'.concat(g,'"'))})))?Office.context.mailbox.item.body.setAsync(s,{coercionType:"html"},(function(t){t.status!==Office.AsyncResultStatus.Failed?(console.log('Replaced selected text with "'.concat(s,'".')),n.asyncContext.completed({allowEvent:!0})):console.log("Action failed with error: "+t.error.message)})):(console.log("body is empty"),n.asyncContext.completed({allowEvent:!0}))):n.asyncContext.completed({allowEvent:!0})}}))}catch(t){console.log(t)}case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}Office.actions.associate("GetDefault",(function(t){var e=o.to?o.to.map((function(t){return t.emailAddress})).join(", "):"",n=o.from?o.from.emailAddress:"",r=o.subject||"blank",i=o.cc?o.cc.map((function(t){return t.emailAddress})):[],u=function(t){var e=new Date(t),n=String(e.getDate()).padStart(2,"0"),r=String(e.getMonth()+1).padStart(2,"0"),o=String(e.getFullYear()).slice(-2),c=String(e.getHours()).padStart(2,"0"),a=String(e.getMinutes()).padStart(2,"0");return"".concat(n,"-").concat(r,"-").concat(o,"_").concat(c,".").concat(a)}(o.dateTimeCreated),s=function(t){var e={utm_campaign:t.campaign+"+to"||0,utm_source:t.source+"+from"||0,utm_medium:t.medium||"default_medium",utm_content:t.content||"default_content",utm_term:t.term||"default_term"},n=new URL(a);return Object.keys(e).forEach((function(t){n.searchParams.append(t,e[t])})),decodeURIComponent(n.toString())}(c={htmlBody:"",campaign:e?[e]:[],source:n,medium:u,content:r,term:i});c.htmlBody=s,Office.context.mailbox.displayNewMessageForm({toRecipients:c.campaign,ccRecipients:i.map((function(t){return{emailAddress:t}})),subject:r}),t.completed()})),Office.actions.associate("SetDefaultData",(function(t){return u.apply(this,arguments)})),Office.actions.associate("validateBody",(function(t){o.body.getAsync("html",{asyncContext:t},f)}))}();
//# sourceMappingURL=commands.js.map